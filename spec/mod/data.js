require("data",function(e,r){function t(e){if(Array.isArray(e))"number"!=typeof e.$key&&(e.$key=1),e.forEach(function(r){"number"!=typeof r.$key&&(r.$key=e.$key++),t(r)});else if("object"==typeof e){var r;for(r in e)t(e[r])}}function n(r,t){switch(t){case"date":return r=e.num2dat(r),s[r.getMonth()]+" "+r.getDate()+", "+r.getFullYear();case"time":return r=e.num2dat(r),r.getHours()+":"+e.pad(r.getMinutes());case"datetime":return r=e.num2dat(r),s[r.getMonth()]+" "+r.getDate()+", "+r.getFullYear()+"  "+r.getHours()+":"+e.pad(r.getMinutes())}return r}function a(e){var r,t,n=0,a=0,u=0,o=[];for(a=0;a<e.length;a++)t=e.charAt(a),0==u?"["!=t&&"."!=t||(r={name:e.substr(n,a-n)},o.push(r),n=a+1,"["==t&&(u=1)):-1==u?"."==t?(n=a+1,u=0):console.error("Bad var name!\n"+e+"\nPos: "+a):"["==t?u++:"]"==t&&(u--,0==u&&(r.index=e.substr(n,a-n),n=a+1,u=-1));return 0==u?o.push({name:e.substr(n)}):console.error("Bad ending for var name!\n"+e),o}var u=(require("tfw.web-service"),require("tfw.storage").local),o=u.get("data",{})||{},s=["January","February","March","April","May","June","July","August","September","October","November","December"];e.get=function(r){var t,n,u,s=o,f=a(r);for(u=0;u<f.length;u++){if(t=f[u],s=s[t.name],"undefined"==typeof s)return;if(Array.isArray(s)&&t.index&&(n=e.get(t.index),s=s.find(function(e){return e.$key==n}),"undefined"==typeof s))return void console.error("Key `"+n+"` not found in `"+r+"` at level "+u+"!")}return s},e.set=function(e,r){t(r);var n,u=o,s=a(e);for(n=0;n<s.length-1;n++)"undefined"==typeof u[s[n].name]&&(u[s[n].name]={}),u=u[s[n].name];u[s.pop().name]=r},e.reset=function(){data={},e.save()},e.save=function(){u.set("data",o)},e.parse=function(r,t){if("undefined"==typeof t&&(t={}),Array.isArray(r)){var a,u,o;for(a=0;a<r.length;a++)if(u=r[a],o=e.parse(u),"undefined"!=typeof o&&"null"!==o)return o}else{if("function"==typeof r)return e.parse(r.call(e));if("string"==typeof r){for(var s,f,i,d=0,y="";;){if(s=r.indexOf("{{",d),-1==s)break;if(y+=r.substr(d,s-d),d=s+2,f=r.indexOf("}}",d),-1==f)break;for(i=r.substr(d,f-d).trim().split("|"),"undefined"!=typeof t[i[0]]?i[0]=t[i[0]]:i[0]=e.get(i[0])||"",a=1;a<i.length;a++)i[0]=n(i[0],i[a]);y+=i[0],d=f+2}return y+r.substr(d)}}},e.num2dat=function(e){for(var r=""+e;r.length<12;)r+="0";return new Date(parseInt(r.substr(0,4)),parseInt(r.substr(4,2))-1,parseInt(r.substr(6,2)),parseInt(r.substr(8,2)),parseInt(r.substr(10,2)),0)},e.pad=function(e,r,t){for("undefined"==typeof r&&(r=2),"undefined"==typeof t&&(t="0"),e=""+e;e.length<r;)e=t+e;return e},e.push=function(r,n){var a=e.get(r);return Array.isArray(a)?(t(a),n.$key=a.$key++,n.$key):(console.error("[Data.push] `"+r+"` is not an array!"),0)}});
//# sourceMappingURL=data.js.map